<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Title</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/bootstrap-grid.min.css">
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
	</style>
</head>
<body>
	<main class="container-fluid full-container no-pad">
		<section class="col-lg-6 col-md-6 col-sm-6 col-12" id="login-form-bg">
			<div id="login-form-container">
				<h1>Log in to <span class="teal-main">Storyboard</span></h1>
				<h4>A valid account is required</h4>
				<form id="login-form" method="POST">
					<label for="email">Username or Email:</label>
					<input type="text" id="email" name="email" placeholder="">
					<label for="password">Password:</label>
					<input type="password" id="password" name="password">
					<input id="login-submit" type="submit" value="LOG IN">
				</form>
				<h5>Not a member? <a href="#">Register for free</a></h5>
				<h5>Forgot your <a href="#">Password</a>?</h5>
			</div>
		</section>
		<div class="col-lg-6 col-md-6 col-sm-6 no-pad" id="login-bg-container"></div>
	</main>
</body>
<script type="text/javascript">
	function login(event){
		var formData = new FormData(document.querySelector("#login-form"));
		var encData = new URLSearchParams(formData.entries());

		event.preventDefault();

		fetch("rest/authenticate", {method:'POST', body: encData})
			.then(function(response){
				if(response.ok) return response.json();
				else throw "Wrong email/password";
			})
			.then(myJson => {
				window.sessionStorage.clear();
				window.sessionStorage.setItem("myJWT", myJson.JWT);
				window.location.assign("/dashboard.html");
			})
			.catch(error => console.log(error));
	}
	document.querySelector("#login-submit").addEventListener("click", login);
</script>
</html>